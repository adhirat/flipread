name = "shopublish"
main = "src/index.ts"
compatibility_date = "2024-05-12"
compatibility_flags = ["nodejs_compat"]

# D1 Database
[[d1_databases]]
binding = "DB"
database_name = "shopublish-db"
database_id = "1671ace4-9f50-4c2e-8e81-69c783ea8f3b"

# R2 Bucket
[[r2_buckets]]
binding = "BUCKET"
bucket_name = "shopublish-files"

# KV Namespace for view counters & sessions
[[kv_namespaces]]
binding = "KV"
id = "fbea1b597d2f4ebd8f6ab8d2ee6da2dc"

# Environment variables (non-sensitive only)
# Secrets (JWT_SECRET, STRIPE_SECRET_KEY, STRIPE_WEBHOOK_SECRET) are set via `wrangler secret put`
[vars]
APP_URL = "https://shopublish.com"

MAX_UPLOAD_SIZE_FREE = "5242880"
MAX_UPLOAD_SIZE_BASIC = "10485760"
MAX_UPLOAD_SIZE_PRO = "52428800"
MAX_UPLOAD_SIZE_BUSINESS = "209715200"

# Cloudflare Email Routing Binding
[[send_email]]
name = "EMAIL"
# Stripe price IDs (not sensitive â€” safe to store here)
STRIPE_PRICE_BASIC_MONTHLY = "price_1T1PzhAeXVAKDgLYmvCApHZ5"
STRIPE_PRICE_BASIC_YEARLY = "price_1T0fl6AeXVAKDgLYAzbkM0cE"
STRIPE_PRICE_PRO_MONTHLY = "price_1T0NYYAeXVAKDgLYjQTLGYyh"
STRIPE_PRICE_PRO_YEARLY = "price_1T0NYYAeXVAKDgLYRvJToQBX"
STRIPE_PRICE_BUSINESS_MONTHLY = "price_1T0NbbAeXVAKDgLYzk4pXSpU"
STRIPE_PRICE_BUSINESS_YEARLY = "price_1T0NbbAeXVAKDgLYTyDj7lsW"

# Static assets
[site]
bucket = "./public"

# Staging Environment
[env.staging]
name = "shopublish-staging"

[env.staging.vars]
APP_URL = "https://staging.shopublish.com"
MAX_UPLOAD_SIZE_FREE = "5242880"
MAX_UPLOAD_SIZE_BASIC = "10485760"
MAX_UPLOAD_SIZE_PRO = "52428800"
MAX_UPLOAD_SIZE_BUSINESS = "209715200"
STRIPE_PRICE_BASIC_MONTHLY = "price_1T2UYfAeXVAKDgLYwNiY9xut"
STRIPE_PRICE_BASIC_YEARLY = "price_1T2UYfAeXVAKDgLYlSzsdRC4"
STRIPE_PRICE_PRO_MONTHLY = "price_1T2UbvAeXVAKDgLYqOizIdsQ"
STRIPE_PRICE_PRO_YEARLY = "price_1T2UbvAeXVAKDgLY63uRvgge"
STRIPE_PRICE_BUSINESS_MONTHLY = "price_1T2UbvAeXVAKDgLY1A1HeXls"
STRIPE_PRICE_BUSINESS_YEARLY = "price_1T2UbvAeXVAKDgLYDSr81YzH"

[[env.staging.d1_databases]]
binding = "DB"
database_name = "shopublish-db-staging"
database_id = "ca0583af-77c6-4647-9278-f57e14255d6e"

[[env.staging.kv_namespaces]]
binding = "KV"
id = "ada4253c67bc46959a5905e5690356cb"

[[env.staging.r2_buckets]]
binding = "BUCKET"
bucket_name = "shopublish-files-staging"

[[env.staging.send_email]]
name = "EMAIL"

